import { Component, OnInit, EventEmitter, Output } from '@angular/core';
import { GridOptions, CellValueChangedEvent } from 'ag-grid-community';

@Component({
	selector: 'app-demandpattern',
	templateUrl: './demandpattern.component.html',
	styleUrls: [ './demandpattern.component.css' ]
})
export class DemandpatternComponent implements OnInit {
	public gridOptions: GridOptions;

	@Output() tablechange = new EventEmitter<any>();

	demandpattern = {
		worksheet: 'HD_Demand_Pattern',
		attributes: [
			{
				slNo: '0.0',
				grades: 'F5400',
				day1: '0.4877054552801556',
				day2: '2.2630391673920283',
				day3: '3.7259426698636378',
				day4: '3.6053378327919203',
				day5: '3.544068659789169',
				day6: '3.9849086966925817',
				day7: '3.4073926383687283',
				day8: '3.6321408786538645',
				day9: '3.0543232638907973',
				day10: '3.03832303399836',
				day11: '2.942658688311086',
				day12: '3.6643542018075994',
				day13: '3.2113986914933936',
				day14: '2.6775728396274956',
				day15: '2.9072701532385654',
				day16: '3.0869623137822466',
				day17: '2.730008182822671',
				day18: '2.91965170586043',
				day19: '2.5134551822385385',
				day20: '2.7588689079169026',
				day21: '3.0877250741873183',
				day22: '2.625297143958964',
				day23: '3.6499859244097337',
				day24: '4.163252722566833',
				day25: '3.9014839947146025',
				day26: '3.654065805646165',
				day27: '4.680492970275936',
				day28: '4.649947076844917',
				day29: '4.627011048850546',
				day30: '4.8053550747247975'
			},
			{
				slNo: '2.0',
				grades: 'P5200',
				day1: '0.08904698743784778',
				day2: '3.18424567644241',
				day3: '2.2051950292199995',
				day4: '3.137624217050866',
				day5: '1.7110075596696404',
				day6: '2.233167904854926',
				day7: '5.7903852564296825',
				day8: '1.7249939974871034',
				day9: '3.7670139188367013',
				day10: '3.2495157195905704',
				day11: '2.2180159305526743',
				day12: '2.373032283029556',
				day13: '3.3469545697188963',
				day14: '2.5082345152650314',
				day15: '1.9161419809924312',
				day16: '4.638835209458563',
				day17: '3.844405541426663',
				day18: '2.6714096231354336',
				day19: '3.2886777454794673',
				day20: '2.209857175159154',
				day21: '3.412690827460972',
				day22: '2.843909022884144',
				day23: '5.24957632748778',
				day24: '5.7042021586401725',
				day25: '2.4089974088458894',
				day26: '5.5065271708200285',
				day27: '2.781969083978236',
				day28: '6.622644908653576',
				day29: '5.5736620723438515',
				day30: '3.788060177647741'
			},
			{
				slNo: '1.0',
				grades: 'P5300',
				day1: '0.12244326367753575',
				day2: '1.2966521665492334',
				day3: '2.2926951228721815',
				day4: '2.751307466766185',
				day5: '2.1636531204335814',
				day6: '2.0947329600402376',
				day7: '2.2538358835014667',
				day8: '2.906157869692506',
				day9: '2.622632060925422',
				day10: '3.7480836162848066',
				day11: '2.9921614315450507',
				day12: '4.339147310977295',
				day13: '4.447916521555513',
				day14: '4.934390206885124',
				day15: '3.468370412135227',
				day16: '3.101773814298294',
				day17: '3.0323404186679785',
				day18: '2.56067723589098',
				day19: '2.2344795831356765',
				day20: '2.780011980376817',
				day21: '2.5588442529017947',
				day22: '2.998320254388711',
				day23: '3.0405521824595256',
				day24: '3.8890504823416174',
				day25: '3.457236349749494',
				day26: '4.919370220562319',
				day27: '6.017693627681772',
				day28: '5.646111316114255',
				day29: '5.597097350983458',
				day30: '5.732261516605934'
			},
			{
				slNo: '3.0',
				grades: 'P5200UV',
				day1: '0.0',
				day2: '0.0',
				day3: '0.0',
				day4: '0.4729474082482028',
				day5: '0.0',
				day6: '0.0',
				day7: '7.188800605372682',
				day8: '3.0268634127884977',
				day9: '3.7835792659856224',
				day10: '3.7835792659856224',
				day11: '3.0457813091184263',
				day12: '7.567158531971245',
				day13: '4.918653045781309',
				day14: '0.7567158531971244',
				day15: '0.0',
				day16: '0.0',
				day17: '6.999621642073402',
				day18: '5.675368898978434',
				day19: '7.567158531971245',
				day20: '8.32387438516837',
				day21: '7.945516458569808',
				day22: '0.3783579265985622',
				day23: '15.13431706394249',
				day24: '0.0',
				day25: '3.7835792659856224',
				day26: '3.7835792659856224',
				day27: '0.0',
				day28: '0.0',
				day29: '5.864547862277714',
				day30: '0.0'
			},
			{
				slNo: '4.0',
				grades: 'B5500',
				day1: '0.5616179234928707',
				day2: '1.8543094945497858',
				day3: '3.5428316501165305',
				day4: '3.461298833157705',
				day5: '3.2897130790353573',
				day6: '3.4731323334420043',
				day7: '2.8400400682319624',
				day8: '3.186761626561948',
				day9: '2.5159204954449894',
				day10: '4.7246433235095555',
				day11: '4.841084966307067',
				day12: '3.919255294160109',
				day13: '3.925290379305101',
				day14: '3.0323344478518353',
				day15: '2.6508223986860076',
				day16: '2.0834060600538304',
				day17: '1.975484537461016',
				day18: '3.407929746875512',
				day19: '1.900696815664241',
				day20: '3.0893719192221605',
				day21: '3.031801940339042',
				day22: '2.772884954118561',
				day23: '3.0523330633323016',
				day24: '3.8609076852583066',
				day25: '3.697546213833548',
				day26: '3.0934460243200403',
				day27: '2.9568282635377994',
				day28: '5.7864548515195775',
				day29: '5.422397215273094',
				day30: '6.049454395338142'
			},
			{
				slNo: '5.0',
				grades: 'B6401',
				day1: '0.48108629238584655',
				day2: '1.9905976026490615',
				day3: '4.168894378240431',
				day4: '4.4676949707001645',
				day5: '3.8420631692733522',
				day6: '4.400055455540519',
				day7: '3.934265595805414',
				day8: '3.702372447421287',
				day9: '3.3369341212853296',
				day10: '2.859508184319686',
				day11: '2.487230773056507',
				day12: '2.9567965783829786',
				day13: '2.9891618263089836',
				day14: '3.2226154420038298',
				day15: '3.470941659721817',
				day16: '3.486912368371018',
				day17: '3.5306825131852357',
				day18: '3.5007831889107353',
				day19: '2.8602402554037267',
				day20: '3.491497445160536',
				day21: '2.9822649460961808',
				day22: '2.4481035001173894',
				day23: '2.7211467494360106',
				day24: '3.4142694500881166',
				day25: '3.377184270172901',
				day26: '3.1193603933909135',
				day27: '3.2590511152429786',
				day28: '4.043523076878077',
				day29: '4.287047678885898',
				day30: '5.167714551565074'
			},
			{
				slNo: '6.0',
				grades: 'HDT6',
				day1: '1.3921877572137433',
				day2: '6.156668156056723',
				day3: '4.08249653128895',
				day4: '6.198998189215249',
				day5: '5.0654939679702755',
				day6: '8.757613526797265',
				day7: '2.6761987630223647',
				day8: '3.5745361333866383',
				day9: '1.5897279119535312',
				day10: '3.292335912329799',
				day11: '1.4298144533546553',
				day12: '1.1664275803682713',
				day13: '1.4392211273898832',
				day14: '2.6526820779342946',
				day15: '2.201161724243351',
				day16: '3.028949039343414',
				day17: '5.945017990264093',
				day18: '4.74096371375491',
				day19: '2.041248265644475',
				day20: '2.963102321096818',
				day21: '3.3205559344354825',
				day22: '1.5925499141640997',
				day23: '1.8343014368694592',
				day24: '2.759313447176486',
				day25: '0.8215385959195193',
				day26: '1.4517857562797951',
				day27: '4.697088298433454',
				day28: '2.843973513493538',
				day29: '7.368583724438203',
				day30: '2.9154642361612715'
			},
			{
				slNo: '7.0',
				grades: 'R5801',
				day1: '0.20243939470620978',
				day2: '1.7833645427400169',
				day3: '2.74558429070297',
				day4: '3.523710714104964',
				day5: '2.4292727364745175',
				day6: '3.4477959410901358',
				day7: '2.264790728275722',
				day8: '0.9489346626853584',
				day9: '2.4609038918973627',
				day10: '1.6454527050964114',
				day11: '1.8586466926463887',
				day12: '2.9100662989017656',
				day13: '3.036590920593147',
				day14: '1.620780403866592',
				day15: '1.2968773723366565',
				day16: '5.96563591274862',
				day17: '5.057821752112961',
				day18: '5.269750493446024',
				day19: '6.2825800900855295',
				day20: '5.541778430082493',
				day21: '5.060984867655245',
				day22: '4.529581456551444',
				day23: '3.084670276835872',
				day24: '3.631256642542638',
				day25: '4.75732577559593',
				day26: '3.504732020851257',
				day27: '3.976668859760109',
				day28: '2.574776051419606',
				day29: '3.7957386507414337',
				day30: '4.791487423452604'
			},
			{
				slNo: '8.0',
				grades: 'E5201S',
				day1: '0.1537776371694228',
				day2: '1.8362748317603792',
				day3: '4.113896072574231',
				day4: '2.402259163333976',
				day5: '2.1602315239382204',
				day6: '3.5942653702584497',
				day7: '2.694436673955879',
				day8: '4.210523513243376',
				day9: '2.527002664530366',
				day10: '2.8513128157548353',
				day11: '4.71661260273379',
				day12: '3.5185241459809733',
				day13: '3.3966496305526688',
				day14: '2.568545578452255',
				day15: '1.3174382647052043',
				day16: '1.4758062791035653',
				day17: '2.178593032853972',
				day18: '4.886686079065941',
				day19: '4.186424032791451',
				day20: '3.9408388510432686',
				day21: '3.107685383991022',
				day22: '2.0679649416365664',
				day23: '3.2777588603231753',
				day24: '4.713399338673533',
				day25: '6.189205617777098',
				day26: '4.5347189050371215',
				day27: '4.702841471046976',
				day28: '4.400335611659962',
				day29: '4.230491654189255',
				day30: '4.045499451863055'
			},
			{
				slNo: '9.0',
				grades: 'E5201',
				day1: '0.41053734964490207',
				day2: '2.8771265077573056',
				day3: '3.227092773028369',
				day4: '4.140874882012575',
				day5: '4.453993737622889',
				day6: '2.95788795358909',
				day7: '2.6247469895329805',
				day8: '1.810402410729158',
				day9: '4.878664340288353',
				day10: '2.8014126522900082',
				day11: '2.92777066441432',
				day12: '3.7032487974115957',
				day13: '3.7890578336078664',
				day14: '3.984231327701345',
				day15: '3.4032536767489483',
				day16: '2.774996929382528',
				day17: '2.5137000015142776',
				day18: '3.242572050146128',
				day19: '2.8670313270283327',
				day20: '4.561002653350002',
				day21: '4.032856448212565',
				day22: '3.5861447009555096',
				day23: '2.7492542185236473',
				day24: '2.5117290376576684',
				day25: '3.3863081948110296',
				day26: '4.220843135072797',
				day27: '4.34333132791767',
				day28: '3.8271310866428507',
				day29: '4.150176869969986',
				day30: '3.2426201224353135'
			}
		]
	};

	columnDefs = [
		{ headerName: 'Grade Code', field: 'slNo', width: 150, editable: false },
		{ headerName: 'Grade Name', field: 'grades', width: 150, editable: false },
		{ headerName: 'Day 1', field: 'day1' },
		{ headerName: 'Day 2', field: 'day2' },
		{ headerName: 'Day 3', field: 'day3' },
		{ headerName: 'Day 4', field: 'day4' },
		{ headerName: 'Day 5', field: 'day5' },
		{ headerName: 'Day 6', field: 'day6' },
		{ headerName: 'Day 7', field: 'day7' },
		{ headerName: 'Day 8', field: 'day8' },
		{ headerName: 'Day 9', field: 'day9' },
		{ headerName: 'Day 10', field: 'day10' },
		{ headerName: 'Day 11', field: 'day11' },
		{ headerName: 'Day 12', field: 'day12' },
		{ headerName: 'Day 13', field: 'day13' },
		{ headerName: 'Day 14', field: 'day14' },
		{ headerName: 'Day 15', field: 'day15' },
		{ headerName: 'Day 16', field: 'day16' },
		{ headerName: 'Day 17', field: 'day17' },
		{ headerName: 'Day 18', field: 'day18' },
		{ headerName: 'Day 19', field: 'day19' },
		{ headerName: 'Day 20', field: 'day20' },
		{ headerName: 'Day 21', field: 'day21' },
		{ headerName: 'Day 22', field: 'day22' },
		{ headerName: 'Day 23', field: 'day23' },
		{ headerName: 'Day 24', field: 'day24' },
		{ headerName: 'Day 25', field: 'day25' },
		{ headerName: 'Day 26', field: 'day26' },
		{ headerName: 'Day 27', field: 'day27' },
		{ headerName: 'Day 28', field: 'day28' },
		{ headerName: 'Day 29', field: 'day29' },
		{ headerName: 'Day 30', field: 'day30' },
		{ headerName: 'Day 31', field: 'day31' }
	];

	rowData = [];

	// gradelist = [ 'F5400', 'P5300', 'P5200', 'P5200UV', 'B5500', 'B6401', 'HDT6', 'R5801', 'E5201S', 'E5201' ];

	defaultColDef = {
		editable: true,
		singleClickEdit: true,
		resizable: true,
		width: 100
	};

	constructor() {
		this.rowData = this.demandpattern.attributes;

		this.gridOptions = {
			rowData: this.rowData,
			columnDefs: this.columnDefs,
			defaultColDef: this.defaultColDef,
			suppressCellSelection: true,
			domLayout: 'autoHeight',

			onCellValueChanged: (event: CellValueChangedEvent) => {
				if (event.value !== String(event.oldValue)) {
					this.tablechange.emit(true);
				}
			}
		};
	}

	ngOnInit() {}
}
